# 北森魔方 - 考勤统计助手

一个用于北森考勤系统的Chrome扩展，可以自动统计和显示考勤数据。

## 功能特性

### 🎯 核心功能
- **自动数据拦截**: 自动拦截北森考勤API请求并解析数据
- **实时统计**: 实时计算总工作时长、出勤天数、短假天数等
- **数据可视化**: 美观的统计面板展示考勤数据
- **数据导出**: 一键复制考勤统计数据

### 🆕 最新改进
- **可拖动面板**: 面板支持拖拽移动，避免遮挡页面内容
- **智能最小化**: 最小化时只显示标题栏，节省空间
- **多重备用方案**: 多种拦截策略确保数据获取的可靠性
- **手动刷新**: 添加重新加载按钮，解决脚本偶尔不生效的问题
- **重试机制**: 自动重试机制提高初始化成功率

## 安装使用

1. 下载扩展文件
2. 在Chrome中打开 `chrome://extensions/`
3. 开启"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择扩展文件夹
6. 访问北森考勤页面即可自动显示统计面板

## 使用说明

### 面板操作
- **拖动**: 点击标题栏（除切换按钮外）可拖动面板
- **最小化**: 点击右上角的 `-` 按钮可最小化面板
- **展开**: 点击 `+` 按钮可展开面板
- **复制数据**: 点击"复制数据"按钮可复制统计结果
- **重新加载**: 点击"重新加载"按钮可重新初始化拦截器

### 数据说明
- **总工作时长**: 所有工作日的累计工作时长
- **出勤天数**: 有工作时长的天数
- **短假天数**: 工作时长少于8小时的天数
- **平均每日时长**: 出勤天数的平均工作时长

## 技术特性

### 可靠性保障
- **多重拦截策略**: 主拦截器 + 备用脚本 + DOM监听
- **自动重试机制**: 初始化失败时自动重试
- **环境检测**: 智能识别主页面和iframe环境
- **错误处理**: 完善的错误处理和用户提示

### 用户体验
- **响应式设计**: 适配不同屏幕尺寸
- **流畅动画**: 平滑的拖拽和切换动画
- **状态反馈**: 实时显示插件状态和操作结果
- **防误操作**: 智能识别点击区域，避免误触发

## 故障排除

### 面板不显示数据
1. 确保已访问北森考勤页面
2. 点击"重新加载"按钮
3. 刷新页面后重试
4. 检查浏览器控制台是否有错误信息

### 面板位置不合适
- 拖动标题栏可移动面板位置
- 点击最小化按钮可减少占用空间

### 数据不准确
- 确保页面已完全加载
- 尝试重新加载插件
- 检查网络连接是否正常

## 更新日志

### v1.1.0
- ✅ 添加面板拖动功能
- ✅ 改进最小化显示效果
- ✅ 增加多重备用拦截策略
- ✅ 添加手动重新加载功能
- ✅ 完善错误处理和重试机制
- ✅ 优化用户体验和界面设计

### v1.0.0
- ✅ 基础考勤数据拦截功能
- ✅ 统计面板显示
- ✅ 数据复制功能

## 技术支持

如遇到问题，请检查：
1. 浏览器控制台错误信息
2. 网络连接状态
3. 北森系统是否正常访问
4. 扩展权限是否正确设置
